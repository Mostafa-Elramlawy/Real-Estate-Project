
@model ClassLibrary2.TransactionsViewModel


@{
    ViewBag.Title = "Create";

}

<!DOCTYPE html>
<html lang="zxx">

@*<style>
        .countdown {
            margin: 0 auto;
            padding-left: 16%;
        }
    </style>*@



<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="html 5 template">
    <meta name="author" content="">
    <title>Find Houses - HTML5 Template</title>
    <!-- FAVICON -->
    <link rel="shortcut icon" type="image/x-icon" href="~/Content/favicon.ico">
    <link rel="stylesheet" href="~/Content/css/jquery-ui.css">
    <!-- GOOGLE FONTS -->
    <link href="~/Content/https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i%7CMontserrat:600,800" rel="stylesheet">
    <!-- FONT AWESOME -->
    <link rel="stylesheet" href="~/Content/css/fontawesome-all.min.css">
    <link rel="stylesheet" href="~/Content/css/fontawesome-5-all.min.css">
    <link rel="stylesheet" href="~/Content/css/font-awesome.min.css">
    <!-- ARCHIVES CSS -->
    <link rel="stylesheet" href="~/Content/css/jquery-ui.css">
    <link rel="stylesheet" href="~/Content/css/search.css">
    <link rel="stylesheet" href="~/Content/css/dashbord-mobile-menu.css">
    <link rel="stylesheet" href="~/Content/css/animate.css">
    <link rel="stylesheet" href="~/Content/css/swiper.min.css">
    <link rel="stylesheet" href="~/Content/css/magnific-popup.css">
    <link rel="stylesheet" href="~/Content/css/lightcase.css">
    <link rel="stylesheet" href="~/Content/css/owl-carousel.css">
    <link rel="stylesheet" href="~/Content/css/owl.carousel.min.css">
    <link rel="stylesheet" href="~/Content/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/Content/css/menu.css">
    <link rel="stylesheet" href="~/Content/css/slick.css">
    <link rel="stylesheet" href="~/Content/css/styles.css">
    <link rel="stylesheet" id="color" href="~/Content/css/default.css">
</head>
<body class="inner-pages ui-elements hd-white">

    <div id="wrapper">
        <!-- START SECTION HEADINGS -->
        <!-- Header Container
        ================================================== -->
        <div class="dash-content-wrap">
            <header id="header-container" class="db-top-header">
                <!-- Header -->
                <div id="header">
                    <div class="container-fluid">
                        <!-- Left Side Content -->
                        <div class="left-side">
                            <!-- Logo -->
                            <div id="logo">
                                <a href="@Url.Action("Index", "Home")">
                                    <img src="~/Content/images/logo.svg" alt="">
                                </a>
                            </div>
                            <!-- Mobile Navigation -->
                            <div class="mmenu-trigger">
                                <button class="hamburger hamburger--collapse" type="button">
                                    <span class="hamburger-box">
                                        <span class="hamburger-inner"></span>
                                    </span>
                                </button>
                            </div>
                            <!-- Main Navigation -->
                            <nav id="navigation" class="style-1">
                                <ul id="responsive">
                                    <li>
                                        <a href="@Url.Action("Index", "Home")">Home</a>
                                    </li>
                                    <li>
                                        <a href="@Url.Action("Index", "property")">Property</a>
                                    </li>
                                    <li>
                                        <a href="~/#">Pages</a>
                                        <ul>
                                            <li>
                                                <a href="@Url.Action("Details", "user")">User Panel</a>
                                                <ul>
                                                    <li><a href="@Url.Action("Details", "user")">User Profile</a></li>

                                                    <li><a href="@Url.Action("MyProperties", "user")">My Properties</a></li>

                                                    <li><a href="@Url.Action("Create", "Property")">Add Property</a></li>

                                                </ul>
                                            </li>
                                            <li><a href="@Url.Action("About", "Home")">About Us</a></li>
                                            <li><a href="@Url.Action("Login", "user")">Login</a></li>
                                            <li><a href="@Url.Action("Create", "user")">Register</a></li>
                                            <li><a href="@Url.Action("Create", "CM")">CraftsMen</a></li>
                                            @if (Session["UserID"] != null)
                                            {
                                                int roleId = Convert.ToInt32(Session["Role_id"]);

                                                if (roleId == 0)
                                                {
                                                    <li><a href="@Url.Action("Index", "Admin")" style="display: none;">Dashboard</a></li>
                                                }
                                                else if (roleId == 1)
                                                {
                                                    <li><a href="@Url.Action("Index", "Admin")">Dashboard</a></li>
                                                }
                                            }
                                            else
                                            {
                                                <li><a href="@Url.Action("Index", "Admin")" style="display: none;">Dashboard</a></li>
                                            }
                                        </ul>
                                    </li>
                                    <li>
                                        <a href="@Url.Action("Index", "auction")">Auction</a>
                                        <ul>
                                            <li>
                                                <a href="@Url.Action("Index", "auction")">Auction List</a>
                                            </li>
                                            <li>
                                                <a href="@Url.Action("Create", "auction")">Create Auction</a>
                                            </li>
                                        </ul>
                                    </li>
                                    @*<li><a href="@Url.Action("Index", "Admin")">Admin Dashbourd</a></li>*@

                                    <li><a href="@Url.Action("Contact", "Home")">Contact</a></li>
                                    <li class="d-none d-xl-none d-block d-lg-block"><a href="~/login.html">Login</a></li>
                                    <li class="d-none d-xl-none d-block d-lg-block"><a href="@Url.Action("Create", "user")">Register</a></li>
                                    <li class="d-none d-xl-none d-block d-lg-block mt-5 pb-4 ml-5 border-bottom-0">
                                </ul>
                            </nav>
                            <div class="clearfix"></div>
                            <!-- Main Navigation / End -->
                        </div>
                        <!-- Left Side Content / End -->
                        <!-- Right Side Content / -->
                        <div class="header-user-menu user-menu add" style="padding-bottom: 0px; padding-left: 110px; ">
                            <div class="header-user-name" style="width: 56px;padding-bottom: 20px;margin-left: -55px;">
                                <span style="margin-left: -35px;">
                                    @{
                                        string defaultImagePath = "~/Content/images/Default_Image.png";
                                        string imageUrl = Url.Content(defaultImagePath);
                                        string userName = Session["UserName"]?.ToString();
                                    }

                                    <img src="@imageUrl" alt="">

                                    @if (!string.IsNullOrEmpty(userName))
                                    {
                                        <a style="padding: 10px;">Hi, @userName!</a>
                                    }

                                </span>
                            </div>
                            <ul>
                                <li><a href="@Url.Action("Details", "user")">profile</a></li>
                                <li><a href="@Url.Action("Create", "property")"> Add Property</a></li>


                                <li><a href="@Url.Action("Logout", "user")">Log Out</a></li>
                            </ul>
                        </div>
                        <!-- Right Side Content / End -->
                    </div>
                </div>
                <!-- Header / End -->
            </header>
        </div>
        <div class="clearfix"></div>
        <!-- Header Container / End -->
        <!-- START SECTION USER PROFILE -->
        <section class="user-page section-padding pt-5" style="
           margin-top: 45px">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-9 col-md-12 col-xs-12 royal-add-property-area section_100 pl-0 user-dash2">
                        <div class="col-lg-12 mobile-dashbord dashbord">
                            <div class="dashboard_navigationbar dashxl">
                                <div class="dropdown">
                                    <button onclick="myFunction()" class="dropbtn"><i class="fa fa-bars pr10 mr-2"></i> Dashboard Navigation</button>
                                    <ul id="myDropdown" class="dropdown-content">
                                        <li>
                                            <a href="~/Content/dashboard.html">
                                                <i class="fa fa-map-marker mr-3"></i> Dashboard
                                            </a>
                                        </li>
                                        <li>
                                            <a href="~/Content/user-profile.html">
                                                <i class="fa fa-user mr-3"></i>Profile
                                            </a>
                                        </li>
                                        <li>
                                            <a href="~/Content/my-listings.html">
                                                <i class="fa fa-list mr-3" aria-hidden="true"></i>My Properties
                                            </a>
                                        </li>
                                        <li>
                                            <a href="~/Content/favorited-listings.html">
                                                <i class="fa fa-heart mr-3" aria-hidden="true"></i>Favorited Properties
                                            </a>
                                        </li>
                                        <li>
                                            <a class="active" href="~/Content/add-property.html">
                                                <i class="fa fa-list mr-3" aria-hidden="true"></i>Add Property
                                            </a>
                                        </li>
                                        <li>
                                            <a href="~/Content/payment-method.html">
                                                <i class="fas fa-credit-card mr-3"></i>Payments
                                            </a>
                                        </li>
                                        <li>
                                            <a href="~/Content/invoice.html">
                                                <i class="fas fa-paste mr-3"></i>Invoices
                                            </a>
                                        </li>
                                        <li>
                                            <a href="~/Content/change-password.html">
                                                <i class="fa fa-lock mr-3"></i>Change Password
                                            </a>
                                        </li>
                                        <li>
                                            <a href="~/Content/index.html">
                                                <i class="fas fa-sign-out-alt mr-3"></i>Log Out
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- END SECTION USER PROFILE -->
    </div>
    @using (Html.BeginForm("Create"))
    {
        @Html.AntiForgeryToken()

        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

        <div class="col-lg-6 col-md-6 countdown  " style="padding-left: 38.5%;">
            <h5 class="uppercase mb40" style="padding-top: 15px; /* page: none; */ padding-left: 97px; /* padding-left: 50px; */ width: 177%;">TIME REMAINING</h5>
            <div class="countdown-boxed">
                <div class="countdown-block countdown-block-days">
                    <div class="countdown-wrap">
                        <div class="countdown-counter" id="countdown-days" data-days="@Model.TimeRemaining.Days"></div>
                        <div class="countdown-title">days</div>
                    </div>
                </div>
                <div class="countdown-block countdown-block-hours">
                    <div class="countdown-wrap">
                        <div class="countdown-counter" id="countdown-hours" data-hours="@Model.TimeRemaining.Hours"></div>
                        <div class="countdown-title">hours</div>
                    </div>
                </div>
                <div class="countdown-block countdown-block-minutes">
                    <div class="countdown-wrap">
                        <div class="countdown-counter" id="countdown-minutes" data-minutes="@Model.TimeRemaining.Minutes"></div>
                        <div class="countdown-title">minutes</div>
                    </div>
                </div>
                <div class="countdown-block countdown-block-seconds">
                    <div class="countdown-wrap">
                        <div class="countdown-counter" id="countdown-seconds" data-seconds="@Model.TimeRemaining.Seconds"></div>
                        <div class="countdown-title">seconds</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-horizontal" style="padding-left: 0%;padding-right: 0%;">
            <div class="col-lg-9 col-md-12 col-xs-12 @*royal-add-property-area section_100 pl-0 user-dash2*@" style="max-width: 100%; padding-top: 0px; padding-bottom: 0px;">
                <div class="single-add-property" style="padding-bottom: 150px;margin-left:50px;">
                    <div class="dashborad-box stat bg-white">
                        <div class="section-body" style="display:flex;margin-bottom: -238px">
                            <div class="row" style="display: block; width: 50%">
                                <div class="texthp">
                                    <div class="col-lg-3 col-md-6 col-xs-12 dar pro mr-3" style="max-width: 90% !important; margin-bottom: 0px; margin-top: 6px; border-radius: 50px;">
                                        <div class="item">
                                            <div class="info">

                                                <p class="type ml-1">Property Title: zoz</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="item">
                                        <div class="info">

                                            <p class="type ml-1">Property Title: @Model.Property.Title</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6 col-xs-12 dar rev mr-3" style="max-width: 90% !important; background: #28599e; border-radius: 50px; ">
                                    <div class="item">

                                        <div class="info">

                                            <p class="type ml-1">Lowest Bidding Price: @Model.lowest_bidding_price</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6 col-xs-12 dar rev mr-3" style="max-width: 90% !important; background: #f91; border-radius: 50px; ">
                                    <div class="item">

                                        <div class="info">

                                            <p class="type ml-1">Highest Price: <span id="highestPrice">@Model.HighestPrice</span></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style="width:50%">
                                <img src="@Url.Content(Model.ImagePath)" alt="Property Image" class="img-responsive" style="
                                width: 100%;
                                background-color: black;
                                height: 88%;
                                border-radius: 40px;
                                margin-left: 51px;
                                ">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(model => model.Property.Price, "Enter the Price that you want to bid ")
                    <div class="col-md-10" style="width:50%">
                        @Html.EditorFor(model => model.transactions.Pro_Price, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.transactions.Pro_Price, "", new { @class = "text-danger" })
                        @if (ViewData.ModelState.ContainsKey("TransactionsViewModel.transactions.Pro_Price"))
                        {
                            var error = ViewData.ModelState["TransactionsViewModel.transactions.Pro_Price"].Errors.FirstOrDefault();
                            if (error != null)
                            {
                                <span class="text-danger">
                                    @error.ErrorMessage.Replace("System.Web.Mvc.ModelError,", "")
                                </span>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
        <input type="hidden" name="transactions.UserID" value="@ViewBag.UserID" />
        <div class="form-group">

            <div class="col-md-offset-2 col-md-10" style="padding-left: 13%;">
                <input type="submit" value="Create" class="btn-success" style="border-radius: 20px; padding: 2%; color: #fff; border-color: #ffffff00; background-color: #1ec38b; height: 50px; width: 200px; ">


            </div>
        </div>
        @Html.HiddenFor(model => model.HighestPrice, new { value = Model.HighestPrice })
        @Html.HiddenFor(model => model.lowest_bidding_price, new { value = Model.lowest_bidding_price })
        @Html.HiddenFor(model => model.TimeRemaining, new { value = Model.TimeRemaining })
        @Html.HiddenFor(model => model.ImagePath, new { value = Model.ImagePath })

    }

    <!--register form end -->
    <script src="~/Scripts/js/jquery-3.5.1.min.js"></script>
    <script src="~/Scripts/js/jquery-ui.js"></script>
    <script src="~/Scripts/js/range-slider.js"></script>
    <script src="~/Scripts/js/tether.min.js"></script>
    <script src="~/Scripts/js/popper.min.js"></script>
    <script src="~/Scripts/js/bootstrap.min.js"></script>
    <script src="~/Scripts/js/mmenu.min.js"></script>
    <script src="~/Scripts/js/mmenu.js"></script>
    <script src="~/Scripts/js/slick.min.js"></script>
    <script src="~/Scripts/js/slick3.js"></script>
    <script src="~/Scripts/js/smooth-scroll.min.js"></script>
    <script src="~/Scripts/js/jquery.barfiller.js"></script>
    <script src="~/Scripts/js/barfiller.js"></script>
    <script src="~/Scripts/js/ajaxchimp.min.js"></script>
    <script src="~/Scripts/js/newsletter.js"></script>
    <script src="~/Scripts/js/color-switcher.js"></script>
    <script src="~/Scripts/js/Countdown.min.js"></script>
    <script src="~/Scripts/js/ui-lement.js"></script>

    <script>
        function joinAuction(auctionId, propertyId) {
            // Redirect to the create transactions page with the property ID as a query parameter
            window.location.href = create_transactions.html ? pro_id = ${ propertyId };
        }
    </script>

    <script>
        $(document).ready(function () {
            var highestPrice = parseInt($("#highestPrice").text());
            var proPriceInput = $("#transactions_Pro_Price");

            proPriceInput.blur(function () {
                var proPrice = parseInt(proPriceInput.val());
                if (proPrice < highestPrice) {
                    proPriceInput.val(highestPrice);
                }
            });
        });
    </script>
    <script>
        function updateCountdown() {
            var daysElem = document.getElementById("countdown-days");
            var hoursElem = document.getElementById("countdown-hours");
            var minutesElem = document.getElementById("countdown-minutes");
            var secondsElem = document.getElementById("countdown-seconds");

            // Retrieve the initial values from the data-* attributes
            var days = parseInt(daysElem.getAttribute("data-days"));
            var hours = parseInt(hoursElem.getAttribute("data-hours"));
            var minutes = parseInt(minutesElem.getAttribute("data-minutes"));
            var seconds = parseInt(secondsElem.getAttribute("data-seconds"));

            // Update the countdown values
            if (seconds > 0) {
                seconds--;
            } else {
                if (minutes > 0) {
                    minutes--;
                    seconds = 59;
                } else {
                    if (hours > 0) {
                        hours--;
                        minutes = 59;
                        seconds = 59;
                    } else {
                        if (days > 0) {
                            days--;
                            hours = 23;
                            minutes = 59;
                            seconds = 59;
                        } else {
                            // Countdown has reached 0
                            // You can perform any desired action here
                            // For example, you can hide the countdown or display a message
                            return; // Exit the function if the countdown has reached 0
                        }
                    }
                }
            }

            // Format the countdown values as strings with leading zeros
            var daysStr = days.toString().padStart(2, "0");
            var hoursStr = hours.toString().padStart(2, "0");
            var minutesStr = minutes.toString().padStart(2, "0");
            var secondsStr = seconds.toString().padStart(2, "0");

            // Update the displayed countdown values
            daysElem.textContent = daysStr;
            hoursElem.textContent = hoursStr;
            minutesElem.textContent = minutesStr;
            secondsElem.textContent = secondsStr;

            // Update the data-* attributes for the next countdown update
            daysElem.setAttribute("data-days", days);
            hoursElem.setAttribute("data-hours", hours);
            minutesElem.setAttribute("data-minutes", minutes);
            secondsElem.setAttribute("data-seconds", seconds);
        }

        // Call the updateCountdown function initially
        updateCountdown();

        // Call the updateCountdown function every second
        setInterval(updateCountdown, 1000);
    </script>

    <script>
    $(document).ready(function () {
    $("#createButton").click(function (e) {
        e.preventDefault(); // Prevent the default form submission

        var proPrice = parseInt($("#transactions_Pro_Price").val());
        var highestPrice = parseInt($("#highestPrice").text());

        if (proPrice > highestPrice) {
            createTransaction(proPrice);
        } else {
            alert("Pro_Price must be higher than the highest price!");
        }
    });

    function createTransaction(proPrice) {
        $.ajax({
            url: "/transactions/Create",
            type: "POST",
            data: {
                id: @Model.Property.Pro_id,
                TransactionsViewModel: {
                    transactions: {
                        Pro_Price: proPrice
                    },
                    Property: {
                        Id: @Model.Property.Pro_id
                    }
                }
            },
            success: function () {
                alert("Transaction created successfully!");
                // Optionally, you can redirect to another page here
            },
            error: function (xhr) {
                if (xhr.status === 400) {
                    var errorMessage = xhr.responseText;
                    displayErrorMessage(errorMessage);
                } else {
                    alert("Failed to create the transaction!");
                }
            }
        });
    }

    function displayErrorMessage(errorMessage) {
        var errorSpan = $("<span class='text-danger'>")
            .text(errorMessage.replace("System.Web.Mvc.ModelError,", ""));

        var errorContainer = $("#errorContainer");
        errorContainer.empty().append(errorSpan);
    }
});

    </script>

</body>

</html>
<style>
    /////////file al sytle
    .dashborad-box .col-lg-3.dar.rev {
        -webkit-box-flex: 0;
        -ms-flex: 0 0 50%;
        flex: 0 0 50%;
        max-width: 100%;
    }

    label {
        font-size: 16px;
        line-height: 24px;
        font-weight: 400;
        margin-bottom: 5px;
        color: #000;
        padding-left: 11%;
    }
    .form-group {
        margin-bottom: 1rem;
        padding-left: 36%;
    }

    .inner-pages .form-control {
        padding: 0.7rem;
        border: 1px solid #dddddd;
        border-radius: 20px;
    }
    .dashborad-box .item .info .type {
        font-size: 22px;
        padding-left: 179px;
        color: #fff;
        margin-bottom: 0px;
    }
</style>
